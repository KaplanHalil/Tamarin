theory toy_authentication

begin 

builtins: asymmetric-encryption, signing


rule Register_pk:
[ Fr(~ltk) ]
-->
[ !Ltk($A, ~ltk), !Pk($A, pk(~ltk)) ]


rule generate_ID:
[]
-->
[ID($A,$IDA)]

rule A0:
[Fr(~RNa), ID($A,$IDA)]
-->
[State($IDA), Out(<$IDA, $IDB ~RNa>) ]
end
